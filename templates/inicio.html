{% extends "base.html" %}

{% block titulo %}Inicio - Ruta de Cobro{% endblock %}

{% block contenido %}
<h2>Listado de Clientes</h2>

<form method="get" class="mb-3">
    <input type="text" name="filtro" class="form-control" placeholder="Buscar por nombre..." value="{{ request.args.get('filtro', '') }}">
</form>

<table class="table table-bordered table-striped">
    <thead class="table-primary">
        <tr>
            <th>Fecha</th>
            <th>Nombre</th>
            <th>Monto Prestado</th>
            <th>Deuda Actual</th>
            <th>Pago</th>
            <th>Acción</th>
        </tr>
    </thead>
    <tbody>
        {% for cliente in clientes %}
        <tr>
            <td>{{ cliente.fecha }}</td>
            <td>{{ cliente.nombre }}</td>
            <td>${{ '%.2f' | format(cliente.monto_prestado) }}</td>
            <td>${{ '%.2f' | format(cliente.deuda_actual) }}</td>
            <td>
                <form method="post" action="{{ url_for('registrar_pago', cliente_id=cliente.id) }}">
                    <input type="number" name="monto_pago" class="form-control" step="0.01" required>
            </td>
            <td>
                    <button type="submit" class="btn btn-success btn-sm">Registrar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{{ url_for('ver_pagos') }}" class="btn btn-primary">Ver Pagos</a>
<a href="{{ url_for('nuevo_cliente') }}" class="btn btn-secondary">Nuevo Cliente</a>
<a href="{{ url_for('logout') }}" class="btn btn-danger float-end">Cerrar Sesión</a>
{% endblock %}

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Clientes - Solo Ricuras</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 20px; }
        h2 { color: #343a40; margin-bottom: 20px; }
        .form-inline input { margin-right: 10px; }
        .btn-primary, .btn-success, .btn-info { margin-right: 5px; }
        .table th { background-color: #007bff; color: white; }
        .table-striped tbody tr:nth-of-type(odd) { background-color: #e9f5ff; }
        .form-pago { display: flex; flex-direction: row; align-items: center; gap: 5px; flex-wrap: wrap; }
        .form-pago input[type="number"] { max-width: 100px; }
        .form-pago button { white-space: nowrap; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Clientes - Solo Ricuras</h2>

        <form method="get" action="/inicio" class="mb-3 form-inline">
            <input type="text" name="filtro" class="form-control" placeholder="Buscar por nombre" value="{{ request.args.get('filtro', '') }}">
            <button type="submit" class="btn btn-primary">Filtrar</button>
            <a href="/nuevo" class="btn btn-success">+ Nuevo Cliente</a>
            <a href="/pagos" class="btn btn-info">Ver Pagos</a>
            <a href="/logout" class="btn btn-secondary">Cerrar Sesi√≥n</a>
        </form>

        {% if clientes %}
        <div class="table-responsive">
            <table class="table table-bordered table-striped">
                <thead>
                    <tr>
                        <th>Fecha Prestada</th>
                        <th>Nombre</th>
                        <th>Monto Prestado</th>
                        <th>Deuda Actual</th>
                        <th>Observaciones</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cliente in clientes %}
                    <tr>
                        <td>{{ cliente.fecha }}</td>
                        <td>{{ cliente.nombre }}</td>
                        <td>${{ '%.2f' | format(cliente.monto) }}</td>
                        <td>${{ '%.2f' | format(cliente.deuda) }}</td>
                        <td>{{ cliente.observaciones }}</td>
                        <td>
                            <form action="/registrar_pago" method="POST" class="form-pago">
                                <input type="hidden" name="cliente_id" value="{{ cliente.id }}">
                                <input type="number" name="monto" step="0.01" placeholder="Pago" required>
                                <button type="submit" class="btn btn-success btn-sm">Registrar</button>
                                <a href="/pagos_cliente/{{ cliente.id }}" class="btn btn-info btn-sm">Ver pagos</a>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <div class="alert alert-warning">No hay clientes registrados.</div>
        {% endif %}
    </div>
</body>
</html>
